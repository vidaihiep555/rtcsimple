<!DOCTYPE html>
<!-- saved from url=(0023)http://tryit.jssip.net/ -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>JsSIP Tryit</title>

<meta name="Author" content="José Luis Millán, Iñaki Baz Castillo">
<meta name="description" content="Tryit JsSIP is a SIP+WebRTC demo application. For commercial support please refer to the Versatica website (http://www.versatica.com) or send an email to info@versatica.com.">
<link rel="stylesheet" href="css/style.css" type="text/css">
<link rel="icon" type="image/png" href="http://tryit.jssip.net/images/favicon.png">
<style type="text/css"></style><script>/**@jsx React.DOM*/

var ReactCSSTransitionGroup = React.addons.CSSTransitionGroup;

var SessionsList = React.createClass({displayName: "SessionsList",
  render: function() {
    return (
      React.createElement("div", null, 
        React.createElement(ReactCSSTransitionGroup, {transitionName: "session"}, 
          this.props.data.map(function (session) {
            return (React.createElement(Session, {key: session.uri, data: session}));
          })
          )
        )
      );
  }
});


var Session = React.createClass({displayName: "Session",
  getInitialState: function() {
    return {
      call: this.props.data.call,
      callStatus: '',
      callStatusText: '',
      displayName: this.props.data.displayName,
      uri: this.props.data.uri,
      isTransferring: false,
      showDtmfBox: false
    }
  },

  componentDidMount: function() {
  //console.log('Tryit: Session::componentMount()');

  // Call session
  if (this.state.call) {
    this.registerCallSession();

  // Chat session
} else {
  this.setState({ callStatus: 'inactive' });
}
},

componentDidUpdate: function(prevProps, prevState) {
  //console.log('Tryit: Session::componentDidUpdate()');

  var self=this;

  // a call is added to the session (living chat session)
  // this.state differs from this.props here
  if (!this.state.call && this.props.data.call) {
    this.registerCallSession();

  // a call is removed from the session (living chat session)
} else if (!this.props.data.call && this.state.callStatus !== 'inactive') {
    // wait a bit to set the 'inactive' callStatus
    window.setTimeout(function(){
      self.setState({ call: null, callStatus: 'inactive', callStatusText: '' });
    },1000);
  }
},

handleMouseOver: function() {
  if (this.state.callStatus === 'inactive') {
    this.setState({ showClose: true});
  }
},

handleMouseOut: function() {
  this.setState({ showClose: false});
},

handleClick: function() {
  GUI.sessionClick(this.state.call);
},

registerCallSession: function() {
  //console.log('Tryit: Session::registerCallSession()');

  var callStatus, remoteIdentity,
  self = this,
  call = this.props.data.call;

  callStatus = call.direction === 'incoming'?'incoming':'trying';
  remoteIdentity = call.remote_identity;


  // Set session state attributes
  this.setCallStatus(callStatus);
  this.setState({
    call: this.props.data.call,
    displayName: remoteIdentity.display_name || remoteIdentity.uri.user
  });

  // Set call event handlers
  call.on('progress', function(e) {
    if (e.originator === 'remote') {
      self.setCallStatus('in-progress');
    }
  });

  call.on('accepted', function() {
    self.setCallStatus('answered');
  });

  call.on('failed', function(e) {
    var cause = e.cause;

    if (e.originator === 'remote' && cause.match("SIP;cause=200", "i")) {
      cause = 'answered_elsewhere';
    }

    if (self.state.showDtmfBox) {
      self.setState({ showDtmfBox: false });
    }

    self.setCallStatus('terminated', cause);
  });

  call.on('ended', function(e) {
    if (self.state.showDtmfBox) {
      self.setState({ showDtmfBox: false });
    }

    self.setCallStatus('terminated', e.cause);
  });

  call.on('hold', function() {
    if (this.isOnHold().local) {
      self.setCallStatus('on-hold');
    } else {
      self.setCallStatus('answered');
    }
  });

  call.on('unhold', function() {
    self.setCallStatus('answered');
  });
},

setCallStatus: function(status, status_text) {
  //console.log('Tryit: Session::setCallStatus()');

  var status_text = status_text || status, local_hold, remote_hold,
  call = this.props.data.call;

  if (call) {
    local_hold = call.isOnHold().local;
    remote_hold = call.isOnHold().remote;

    if (local_hold || remote_hold) {
      status_text = "hold by";
      status_text += local_hold?" local ":"";

      if (remote_hold) {
        if (local_hold)
          status_text += "/";
        status_text += " remote";
      }
    }
  }

  this.setState({
    callStatus: status,
    callStatusText: status_text
  });
},

// Button handlers
clickClose: function() {
  //console.log('Tryit: Session::clickClose()');
  GUI.buttonCloseClick(this.state.uri);
},

clickDial: function() {
  //console.log('Tryit: Session::clickDial()');

  if (this.state.callStatus === 'incoming') {
    GUI.buttonAnswerClick(this.state.call);
  } else {
    GUI.buttonDialClick(this.state.uri);
  }
},

clickHold: function() {
  //console.log('Tryit: Session::clickHold()');
  GUI.buttonHoldClick(this.state.call);
},

clickResume: function() {
  //console.log('Tryit: Session::clickResume()');
  GUI.buttonResumeClick(this.state.call);
},

clickTransfer: function() {
  //console.log('Tryit: Session::clickTransfer()');

  var isTransferring= !this.state.isTransferring;

  this.setState({ isTransferring : isTransferring });

  if (!isTransferring) {
    GUI.buttonTransferClick(this.state.call);
  }
},

clickHangup: function() {
  //console.log('Tryit: Session::clickHangup()');
  GUI.buttonHangupClick(this.state.call);
},

toggleDtmf: function() {
  //console.log('Tryit: Session::toggleDtmf()');

  this.setState({ showDtmfBox: !this.state.showDtmfBox });
},

renderClose: function() {
  var display = this.state.showClose?'block':'none';

  return (
    React.createElement("div", {className: "close", style: { display: display}, onClick: this.clickClose})
    );
},

renderTransferButton: function() {
  var image;

  if (this.state.isTransferring === true) {
    image = '../images/icon-transfer-active.png';
  } else {
    image = '../images/icon-transfer-inactive.png';
  }

  return (
    React.createElement("div", {className: "button transfer", 
      style: { backgroundImage: 'url(' + image + ')'}, 
      onClick: this.clickTransfer}
      )
    );
},

render: function() {
  return (
    React.createElement("div", {className: "session", 
      onMouseOver: this.handleMouseOver, 
      onMouseOut: this.handleMouseOut}, 
      this.renderClose(), 
      React.createElement("div", {className: "container", 
        onClick: this.handleClick}, 
        React.createElement("div", {className: "peer"}, 
          React.createElement("span", {className: "display-name"}, this.state.displayName), 
          React.createElement("span", null, "<"), React.createElement("span", {className: "uri"}, this.state.uri), React.createElement("span", null, ">")
          ), 
        React.createElement("div", {className:  'call ' + this.state.callStatus}, 
          React.createElement("div", {className: "button dial", onClick: this.clickDial}), 
          React.createElement("div", {className: "button hangup", onClick: this.clickHangup}), 
          React.createElement("div", {className: "button dtmf", onClick: this.toggleDtmf}), 
          React.createElement("div", {className: "button hold", onClick: this.clickHold}), 
          React.createElement("div", {className: "button resume", onClick: this.clickResume}), 
          this.renderTransferButton(), 
          this.state.showDtmfBox? React.createElement(DtmfBox, {call: this.state.call}) : null, 
          React.createElement("div", {className: "call-status"}, this.state.callStatusText)
          ), 
        React.createElement(ChatBox, {data: this.props.data}
          )
        )
)
);
}
});

var DtmfBox = React.createClass({displayName: "DtmfBox",
  componentDidMount: function() {
    var
    self = this,
    dtmf_button = $(React.findDOMNode(this)).find(".dtmf-button");

    dtmf_button.click(function() {
      GUI.buttonDtmfClick(self.props.call, $(this).text());
    });
  },

  render: function() {
    return (
      React.createElement("div", {className: "dtmf-box"}, 
        React.createElement("div", {className: "dtmf-row"}, 
          React.createElement("div", {className: "dtmf-button digit-1"}, "1"), 
          React.createElement("div", {className: "dtmf-button digit-2"}, "2"), 
          React.createElement("div", {className: "dtmf-button digit-3"}, "3")
          ), 
        React.createElement("div", {className: "dtmf-row"}, 
          React.createElement("div", {className: "dtmf-button digit-4"}, "4"), 
          React.createElement("div", {className: "dtmf-button digit-5"}, "5"), 
          React.createElement("div", {className: "dtmf-button digit-6"}, "6")
          ), 
        React.createElement("div", {className: "dtmf-row"}, 
          React.createElement("div", {className: "dtmf-button digit-7"}, "7"), 
          React.createElement("div", {className: "dtmf-button digit-8"}, "8"), 
          React.createElement("div", {className: "dtmf-button digit-9"}, "9")
          ), 
        React.createElement("div", {className: "dtmf-row"}, 
          React.createElement("div", {className: "dtmf-button digit-asterisk"}, "*"), 
          React.createElement("div", {className: "dtmf-button digit-0"}, "0"), 
          React.createElement("div", {className: "dtmf-button digit-pound"}, "#")
          )
        )
);
}
});

var ChatBox = React.createClass({displayName: "ChatBox",
  getInitialState: function() {
    return {
      text: '',
      numMessages: 0
    };
  },

  componentDidMount: function() {
  //console.log('Tryit: ChatBox::componentDidMount()');
  $(React.findDOMNode(this)).find("input").focus();
},

componentDidUpdate: function(prevProps, prevState) {
  //console.log('Tryit: ChatBox::componentDidUpdate()');

  var node;

  // new chat message added
  if (this.props.data.chat.length > this.state.numMessages) {
    node = $(React.findDOMNode(this));

    // scroll the messages list
    node.find(".chatting").scrollTop(1e4);
    // focus the input
    node.find("input").focus();

    this.setState({ numMessages: this.props.data.chat.length });
  }
},

handleBlur: function() {
  //console.log('Tryit: ChatBox::handleBlur()');

  GUI.chatInputBlur(this.props.data.uri);
},

handleFocus: function() {
  //console.log('Tryit: ChatBox::handleFocus()');
},

// fires everytime the input changes (not when pressing enter)
handleChange: function(e) {
  //console.log('Tryit: ChatBox::handleChange()');

  var text = e.target.value;

  this.setState({ text: text });

  GUI.chatInputChange(this.props.data.uri, text);
},

// fires everytime a key is pressed (including enter)
handleKeyDown: function(e) {
  //console.log('Tryit: ChatBox::handleKeyDown()');

  var text = this.state.text;

  // Enter pressed? clear text
  if (e.which == 13) {
    this.setState({ text: ''});
    GUI.chatInputChange(this.props.data.uri, text, true /*enter*/);
  }
},

render: function() {
  var
  self = this,
  displayName = this.props.data.displayName,

  correctMessage = function(message) {
    return (
      React.createElement("b", null, (message.who==='peer'?displayName:'me'))
      );
  },

  errorMessage = function() {
    return (
      React.createElement("p", {className: "error"}),React.createElement("i", null, "message failed")
      );
  },

  chatMessages = this.props.data.chat.map(function(message,i) {
    return (
      React.createElement("p", {className: message.who, key: i}, 
        message.who==='error'?errorMessage():correctMessage(message), 
        ": ", message.text
        )
      );
  });

  return (
    React.createElement("div", {className: "chat"}, 
     this.props.data.chat.length !== 0 &&
     React.createElement("div", {className: "chatting"}, chatMessages), 

     React.createElement("input", {className: this.state.text===''?'inactive':'', type: "text", name: "chat-input", placeholder: "type to chat...", 
      onChange: this.handleChange, 
      onKeyDown: this.handleKeyDown, 
      onFocus: this.handleFocus, 
      onBlur: this.handleBlur, 
      value: this.state.text}
      ), 
     (this.props.data.isComposing? React.createElement("div", {className: "iscomposing"}) : null) 
     )
    );
}
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHJhbnNmb3JtZWQuanMiLCJzb3VyY2VzIjpbImpzL3Nlc3Npb25zLmpzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxtQkFBbUI7O0FBRW5CLElBQUksdUJBQXVCLEdBQUcsS0FBSyxDQUFDLE1BQU0sQ0FBQyxrQkFBa0IsQ0FBQzs7QUFFOUQsSUFBSSxrQ0FBa0MsNEJBQUE7RUFDcEMsTUFBTSxFQUFFLFdBQVc7SUFDakI7TUFDRSxvQkFBQSxLQUFJLEVBQUEsSUFBQyxFQUFBO1FBQ0gsb0JBQUMsdUJBQXVCLEVBQUEsQ0FBQSxDQUFDLGNBQUEsRUFBYyxDQUFDLFNBQVUsQ0FBQSxFQUFBO1FBQ2pELElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxVQUFVLE9BQU8sRUFBRTtVQUN0QyxRQUFRLG9CQUFDLE9BQU8sRUFBQSxDQUFBLENBQUMsR0FBQSxFQUFHLENBQUUsT0FBTyxDQUFDLEdBQUcsRUFBQyxDQUFDLElBQUEsRUFBSSxDQUFFLE9BQVEsQ0FBQSxDQUFHLENBQUEsRUFBRTtTQUN2RCxDQUFFO1FBQ3VCLENBQUE7TUFDdEIsQ0FBQTtNQUNOO0dBQ0g7QUFDSCxDQUFDLENBQUMsQ0FBQztBQUNIOztBQUVBLElBQUksNkJBQTZCLHVCQUFBO0VBQy9CLGVBQWUsRUFBRSxXQUFXO0lBQzFCLE9BQU87TUFDTCxJQUFJLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSTtNQUMxQixVQUFVLEVBQUUsRUFBRTtNQUNkLGNBQWMsRUFBRSxFQUFFO01BQ2xCLFdBQVcsRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxXQUFXO01BQ3hDLEdBQUcsRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxHQUFHO01BQ3hCLGNBQWMsRUFBRSxLQUFLO01BQ3JCLFdBQVcsRUFBRSxLQUFLO0tBQ25CO0FBQ0wsR0FBRzs7QUFFSCxFQUFFLGlCQUFpQixFQUFFLFdBQVc7QUFDaEM7QUFDQTs7SUFF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LENBQUMsVUFBVyxDQUFBLEVBQUMsWUFBbUIsQ0FBQSxFQUFBO1FBQy9DO1FBQ0Qsb0JBQUEsT0FBTSxFQUFBLENBQUEsQ0FBQyxTQUFBLEVBQVMsQ0FBRSxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksR0FBRyxFQUFFLENBQUMsVUFBVSxDQUFDLEVBQUUsRUFBQyxDQUFDLElBQUEsRUFBSSxDQUFDLE1BQUEsRUFBTSxDQUFDLElBQUEsRUFBSSxDQUFDLFlBQUEsRUFBWSxDQUFDLFdBQUEsRUFBVyxDQUFDLGlCQUFBLEVBQWlCO1VBQy9HLFFBQUEsRUFBUSxDQUFFLElBQUksQ0FBQyxZQUFZLEVBQUM7VUFDNUIsU0FBQSxFQUFTLENBQUUsSUFBSSxDQUFDLGFBQWEsRUFBQztVQUM5QixPQUFBLEVBQU8sQ0FBRSxJQUFJLENBQUMsV0FBVyxFQUFDO1VBQzFCLE1BQUEsRUFBTSxDQUFFLElBQUksQ0FBQyxVQUFVLEVBQUM7VUFDeEIsS0FBQSxFQUFLLENBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFLLENBQUE7UUFDdkIsQ0FBQSxFQUFBO1FBQ0QsRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsb0JBQUEsS0FBSSxFQUFBLENBQUEsQ0FBQyxTQUFBLEVBQVMsQ0FBQyxhQUFjLENBQU0sQ0FBQSxHQUFHLElBQUksRUFBRztNQUN6RSxDQUFBO01BQ047R0FDSDtDQUNGLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8qKkBqc3ggUmVhY3QuRE9NKi9cblxudmFyIFJlYWN0Q1NTVHJhbnNpdGlvbkdyb3VwID0gUmVhY3QuYWRkb25zLkNTU1RyYW5zaXRpb25Hcm91cDtcblxudmFyIFNlc3Npb25zTGlzdCA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcbiAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gKFxuICAgICAgPGRpdj5cbiAgICAgICAgPFJlYWN0Q1NTVHJhbnNpdGlvbkdyb3VwIHRyYW5zaXRpb25OYW1lPVwic2Vzc2lvblwiPlxuICAgICAgICB7dGhpcy5wcm9wcy5kYXRhLm1hcChmdW5jdGlvbiAoc2Vzc2lvbikge1xuICAgICAgICAgIHJldHVybiAoPFNlc3Npb24ga2V5PXtzZXNzaW9uLnVyaX0gZGF0YT17c2Vzc2lvbn0gLz4pO1xuICAgICAgICB9KX1cbiAgICAgICAgPC9SZWFjdENTU1RyYW5zaXRpb25Hcm91cD5cbiAgICAgIDwvZGl2PlxuICAgICk7XG4gIH1cbn0pO1xuXG5cbnZhciBTZXNzaW9uID0gUmVhY3QuY3JlYXRlQ2xhc3Moe1xuICBnZXRJbml0aWFsU3RhdGU6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB7XG4gICAgICBjYWxsOiB0aGlzLnByb3BzLmRhdGEuY2FsbCxcbiAgICAgIGNhbGxTdGF0dXM6ICcnLFxuICAgICAgY2FsbFN0YXR1c1RleHQ6ICcnLFxuICAgICAgZGlzcGxheU5hbWU6IHRoaXMucHJvcHMuZGF0YS5kaXNwbGF5TmFtZSxcbiAgICAgIHVyaTogdGhpcy5wcm9wcy5kYXRhLnVyaSxcbiAgICAgIGlzVHJhbnNmZXJyaW5nOiBmYWxzZSxcbiAgICAgIHNob3dEdG1mQm94OiBmYWxzZVxuICAgIH1cbiAgfSxcblxuICBjb21wb25lbnREaWRNb3VudDogZnVuY3Rpb24oKSB7XG4gICAgLy9jb25zb2xlLmxvZygnVHJ5aXQ6IFNlc3Npb246OmNvbXBvbmVudE1vdW50KCknKTtcblxuICAgIC8vIENhbGwgc2Vzc2lvblxuICAgIGlmICh0aGlzLnN0YXRlLmNhbGwpIHtcbiAgICAgIHRoaXMucmVnaXN0ZXJDYWxsU2Vzc2lvbigpO1xuXG4gICAgLy8gQ2hhdCBzZXNzaW9uXG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoeyBjYWxsU3RhdHVzOiAnaW5hY3RpdmUnIH0pO1xuICAgIH1cbiAgfSxcblxuICBjb21wb25lbnREaWRVcGRhdGU6IGZ1bmN0aW9uKHByZXZQcm9wcywgcHJldlN0YXRlKSB7XG4gICAgLy9jb25zb2xlLmxvZygnVHJ5aXQ6IFNlc3Npb246OmNvbXBvbmVudERpZFVwZGF0ZSgpJyk7XG5cbiAgICB2YXIgc2VsZj10aGlzO1xuXG4gICAgLy8gYSBjYWxsIGlzIGFkZGVkIHRvIHRoZSBzZXNzaW9uIChsaXZpbmcgY2hhdCBzZXNzaW9uKVxuICAgIC8vIHRoaXMuc3RhdGUgZGlmZmVycyBmcm9tIHRoaXMucHJvcHMgaGVyZVxuICAgIGlmICghdGhpcy5zdGF0ZS5jYWxsICYmIHRoaXMucHJvcHMuZGF0YS5jYWxsKSB7XG4gICAgICB0aGlzLnJlZ2lzdGVyQ2FsbFNlc3Npb24oKTtcblxuICAgIC8vIGEgY2FsbCBpcyByZW1vdmVkIGZyb20gdGhlIHNlc3Npb24gKGxpdmluZyBjaGF0IHNlc3Npb24pXG4gICAgfSBlbHNlIGlmICghdGhpcy5wcm9wcy5kYXRhLmNhbGwgJiYgdGhpcy5zdGF0ZS5jYWxsU3RhdHVzICE9PSAnaW5hY3RpdmUnKSB7XG4gICAgICAvLyB3YWl0IGEgYml0IHRvIHNldCB0aGUgJ2luYWN0aXZlJyBjYWxsU3RhdHVzXG4gICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICBzZWxmLnNldFN0YXRlKHsgY2FsbDogbnVsbCwgY2FsbFN0YXR1czogJ2luYWN0aXZlJywgY2FsbFN0YXR1c1RleHQ6ICcnIH0pO1xuICAgICAgfSwxMDAwKTtcbiAgICB9XG4gIH0sXG5cbiAgaGFuZGxlTW91c2VPdmVyOiBmdW5jdGlvbigpIHtcbiAgICBpZiAodGhpcy5zdGF0ZS5jYWxsU3RhdHVzID09PSAnaW5hY3RpdmUnKSB7XG4gICAgICB0aGlzLnNldFN0YXRlKHsgc2hvd0Nsb3NlOiB0cnVlfSk7XG4gICAgfVxuICB9LFxuXG4gIGhhbmRsZU1vdXNlT3V0OiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLnNldFN0YXRlKHsgc2hvd0Nsb3NlOiBmYWxzZX0pO1xuICB9LFxuXG4gIGhhbmRsZUNsaWNrOiBmdW5jdGlvbigpIHtcbiAgICBHVUkuc2Vzc2lvbkNsaWNrKHRoaXMuc3RhdGUuY2FsbCk7XG4gIH0sXG5cbiAgcmVnaXN0ZXJDYWxsU2Vzc2lvbjogZnVuY3Rpb24oKSB7XG4gICAgLy9jb25zb2xlLmxvZygnVHJ5aXQ6IFNlc3Npb246OnJlZ2lzdGVyQ2FsbFNlc3Npb24oKScpO1xuXG4gICAgdmFyIGNhbGxTdGF0dXMsIHJlbW90ZUlkZW50aXR5LFxuICAgICAgc2VsZiA9IHRoaXMsXG4gICAgICBjYWxsID0gdGhpcy5wcm9wcy5kYXRhLmNhbGw7XG5cbiAgICBjYWxsU3RhdHVzID0gY2FsbC5kaXJlY3Rpb24gPT09ICdpbmNvbWluZyc/J2luY29taW5nJzondHJ5aW5nJztcbiAgICByZW1vdGVJZGVudGl0eSA9IGNhbGwucmVtb3RlX2lkZW50aXR5O1xuXG5cbiAgICAvLyBTZXQgc2Vzc2lvbiBzdGF0ZSBhdHRyaWJ1dGVzXG4gICAgdGhpcy5zZXRDYWxsU3RhdHVzKGNhbGxTdGF0dXMpO1xuICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgY2FsbDogdGhpcy5wcm9wcy5kYXRhLmNhbGwsXG4gICAgICBkaXNwbGF5TmFtZTogcmVtb3RlSWRlbnRpdHkuZGlzcGxheV9uYW1lIHx8IHJlbW90ZUlkZW50aXR5LnVyaS51c2VyXG4gICAgfSk7XG5cbiAgICAvLyBTZXQgY2FsbCBldmVudCBoYW5kbGVyc1xuICAgIGNhbGwub24oJ3Byb2dyZXNzJywgZnVuY3Rpb24oZSkge1xuICAgICAgaWYgKGUub3JpZ2luYXRvciA9PT0gJ3JlbW90ZScpIHtcbiAgICAgICAgc2VsZi5zZXRDYWxsU3RhdHVzKCdpbi1wcm9ncmVzcycpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgY2FsbC5vbignYWNjZXB0ZWQnLCBmdW5jdGlvbigpIHtcbiAgICAgIHNlbGYuc2V0Q2FsbFN0YXR1cygnYW5zd2VyZWQnKTtcbiAgICB9KTtcblxuICAgIGNhbGwub24oJ2ZhaWxlZCcsIGZ1bmN0aW9uKGUpIHtcbiAgICAgIHZhciBjYXVzZSA9IGUuY2F1c2U7XG5cbiAgICAgIGlmIChlLm9yaWdpbmF0b3IgPT09ICdyZW1vdGUnICYmIGNhdXNlLm1hdGNoKFwiU0lQO2NhdXNlPTIwMFwiLCBcImlcIikpIHtcbiAgICAgICAgY2F1c2UgPSAnYW5zd2VyZWRfZWxzZXdoZXJlJztcbiAgICAgIH1cblxuICAgICAgaWYgKHNlbGYuc3RhdGUuc2hvd0R0bWZCb3gpIHtcbiAgICAgICAgc2VsZi5zZXRTdGF0ZSh7IHNob3dEdG1mQm94OiBmYWxzZSB9KTtcbiAgICAgIH1cblxuICAgICAgc2VsZi5zZXRDYWxsU3RhdHVzKCd0ZXJtaW5hdGVkJywgY2F1c2UpO1xuICAgIH0pO1xuXG4gICAgY2FsbC5vbignZW5kZWQnLCBmdW5jdGlvbihlKSB7XG4gICAgICBpZiAoc2VsZi5zdGF0ZS5zaG93RHRtZkJveCkge1xuICAgICAgICBzZWxmLnNldFN0YXRlKHsgc2hvd0R0bWZCb3g6IGZhbHNlIH0pO1xuICAgICAgfVxuXG4gICAgICBzZWxmLnNldENhbGxTdGF0dXMoJ3Rlcm1pbmF0ZWQnLCBlLmNhdXNlKTtcbiAgICB9KTtcblxuICAgIGNhbGwub24oJ2hvbGQnLCBmdW5jdGlvbigpIHtcbiAgICAgIGlmICh0aGlzLmlzT25Ib2xkKCkubG9jYWwpIHtcbiAgICAgICAgc2VsZi5zZXRDYWxsU3RhdHVzKCdvbi1ob2xkJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzZWxmLnNldENhbGxTdGF0dXMoJ2Fuc3dlcmVkJyk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBjYWxsLm9uKCd1bmhvbGQnLCBmdW5jdGlvbigpIHtcbiAgICAgIHNlbGYuc2V0Q2FsbFN0YXR1cygnYW5zd2VyZWQnKTtcbiAgICB9KTtcbiAgfSxcblxuICBzZXRDYWxsU3RhdHVzOiBmdW5jdGlvbihzdGF0dXMsIHN0YXR1c190ZXh0KSB7XG4gICAgLy9jb25zb2xlLmxvZygnVHJ5aXQ6IFNlc3Npb246OnNldENhbGxTdGF0dXMoKScpO1xuXG4gICAgdmFyIHN0YXR1c190ZXh0ID0gc3RhdHVzX3RleHQgfHwgc3RhdHVzLCBsb2NhbF9ob2xkLCByZW1vdGVfaG9sZCxcbiAgICAgICAgY2FsbCA9IHRoaXMucHJvcHMuZGF0YS5jYWxsO1xuXG4gICAgaWYgKGNhbGwpIHtcbiAgICAgIGxvY2FsX2hvbGQgPSBjYWxsLmlzT25Ib2xkKCkubG9jYWw7XG4gICAgICByZW1vdGVfaG9sZCA9IGNhbGwuaXNPbkhvbGQoKS5yZW1vdGU7XG5cbiAgICAgIGlmIChsb2NhbF9ob2xkIHx8IHJlbW90ZV9ob2xkKSB7XG4gICAgICAgIHN0YXR1c190ZXh0ID0gXCJob2xkIGJ5XCI7XG4gICAgICAgIHN0YXR1c190ZXh0ICs9IGxvY2FsX2hvbGQ/XCIgbG9jYWwgXCI6XCJcIjtcblxuICAgICAgICBpZiAocmVtb3RlX2hvbGQpIHtcbiAgICAgICAgICBpZiAobG9jYWxfaG9sZClcbiAgICAgICAgICAgIHN0YXR1c190ZXh0ICs9IFwiL1wiO1xuICAgICAgICAgIHN0YXR1c190ZXh0ICs9IFwiIHJlbW90ZVwiO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICBjYWxsU3RhdHVzOiBzdGF0dXMsXG4gICAgICBjYWxsU3RhdHVzVGV4dDogc3RhdHVzX3RleHRcbiAgICB9KTtcbiAgfSxcblxuICAvLyBCdXR0b24gaGFuZGxlcnNcbiAgY2xpY2tDbG9zZTogZnVuY3Rpb24oKSB7XG4gICAgLy9jb25zb2xlLmxvZygnVHJ5aXQ6IFNlc3Npb246OmNsaWNrQ2xvc2UoKScpO1xuICAgIEdVSS5idXR0b25DbG9zZUNsaWNrKHRoaXMuc3RhdGUudXJpKTtcbiAgfSxcblxuICBjbGlja0RpYWw6IGZ1bmN0aW9uKCkge1xuICAgIC8vY29uc29sZS5sb2coJ1RyeWl0OiBTZXNzaW9uOjpjbGlja0RpYWwoKScpO1xuXG4gICAgaWYgKHRoaXMuc3RhdGUuY2FsbFN0YXR1cyA9PT0gJ2luY29taW5nJykge1xuICAgICAgR1VJLmJ1dHRvbkFuc3dlckNsaWNrKHRoaXMuc3RhdGUuY2FsbCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIEdVSS5idXR0b25EaWFsQ2xpY2sodGhpcy5zdGF0ZS51cmkpO1xuICAgIH1cbiAgfSxcblxuICBjbGlja0hvbGQ6IGZ1bmN0aW9uKCkge1xuICAgIC8vY29uc29sZS5sb2coJ1RyeWl0OiBTZXNzaW9uOjpjbGlja0hvbGQoKScpO1xuICAgIEdVSS5idXR0b25Ib2xkQ2xpY2sodGhpcy5zdGF0ZS5jYWxsKTtcbiAgfSxcblxuICBjbGlja1Jlc3VtZTogZnVuY3Rpb24oKSB7XG4gICAgLy9jb25zb2xlLmxvZygnVHJ5aXQ6IFNlc3Npb246OmNsaWNrUmVzdW1lKCknKTtcbiAgICBHVUkuYnV0dG9uUmVzdW1lQ2xpY2sodGhpcy5zdGF0ZS5jYWxsKTtcbiAgfSxcblxuICBjbGlja1RyYW5zZmVyOiBmdW5jdGlvbigpIHtcbiAgICAvL2NvbnNvbGUubG9nKCdUcnlpdDogU2Vzc2lvbjo6Y2xpY2tUcmFuc2ZlcigpJyk7XG5cbiAgICB2YXIgaXNUcmFuc2ZlcnJpbmc9ICF0aGlzLnN0YXRlLmlzVHJhbnNmZXJyaW5nO1xuXG4gICAgdGhpcy5zZXRTdGF0ZSh7IGlzVHJhbnNmZXJyaW5nIDogaXNUcmFuc2ZlcnJpbmcgfSk7XG5cbiAgICBpZiAoIWlzVHJhbnNmZXJyaW5nKSB7XG4gICAgICBHVUkuYnV0dG9uVHJhbnNmZXJDbGljayh0aGlzLnN0YXRlLmNhbGwpO1xuICAgIH1cbiAgfSxcblxuICBjbGlja0hhbmd1cDogZnVuY3Rpb24oKSB7XG4gICAgLy9jb25zb2xlLmxvZygnVHJ5aXQ6IFNlc3Npb246OmNsaWNrSGFuZ3VwKCknKTtcbiAgICBHVUkuYnV0dG9uSGFuZ3VwQ2xpY2sodGhpcy5zdGF0ZS5jYWxsKTtcbiAgfSxcblxuICB0b2dnbGVEdG1mOiBmdW5jdGlvbigpIHtcbiAgICAvL2NvbnNvbGUubG9nKCdUcnlpdDogU2Vzc2lvbjo6dG9nZ2xlRHRtZigpJyk7XG5cbiAgICB0aGlzLnNldFN0YXRlKHsgc2hvd0R0bWZCb3g6ICF0aGlzLnN0YXRlLnNob3dEdG1mQm94IH0pO1xuICB9LFxuXG4gIHJlbmRlckNsb3NlOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgZGlzcGxheSA9IHRoaXMuc3RhdGUuc2hvd0Nsb3NlPydibG9jayc6J25vbmUnO1xuXG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY2xvc2VcIiBzdHlsZT17eyBkaXNwbGF5OiBkaXNwbGF5IH19IG9uQ2xpY2s9e3RoaXMuY2xpY2tDbG9zZX0+PC9kaXY+XG4gICAgKTtcbiAgfSxcblxuICByZW5kZXJUcmFuc2ZlckJ1dHRvbjogZnVuY3Rpb24oKSB7XG4gICAgdmFyIGltYWdlO1xuXG4gICAgaWYgKHRoaXMuc3RhdGUuaXNUcmFuc2ZlcnJpbmcgPT09IHRydWUpIHtcbiAgICAgIGltYWdlID0gJy4uL2ltYWdlcy9pY29uLXRyYW5zZmVyLWFjdGl2ZS5wbmcnO1xuICAgIH0gZWxzZSB7XG4gICAgICBpbWFnZSA9ICcuLi9pbWFnZXMvaWNvbi10cmFuc2Zlci1pbmFjdGl2ZS5wbmcnO1xuICAgIH1cblxuICAgIHJldHVybiAoXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImJ1dHRvbiB0cmFuc2ZlclwiXG4gICAgICAgIHN0eWxlPXt7IGJhY2tncm91bmRJbWFnZTogJ3VybCgnICsgaW1hZ2UgKyAnKScgfX1cbiAgICAgICAgb25DbGljaz17dGhpcy5jbGlja1RyYW5zZmVyfT5cbiAgICAgIDwvZGl2PlxuICAgICk7XG4gIH0sXG5cbiAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gKFxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJzZXNzaW9uXCJcbiAgICAgICAgb25Nb3VzZU92ZXI9e3RoaXMuaGFuZGxlTW91c2VPdmVyfVxuICAgICAgICBvbk1vdXNlT3V0PXt0aGlzLmhhbmRsZU1vdXNlT3V0fT5cbiAgICAgICAge3RoaXMucmVuZGVyQ2xvc2UoKX1cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb250YWluZXJcIlxuICAgICAgICAgIG9uQ2xpY2s9e3RoaXMuaGFuZGxlQ2xpY2t9PlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicGVlclwiPlxuICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwiZGlzcGxheS1uYW1lXCI+e3RoaXMuc3RhdGUuZGlzcGxheU5hbWV9PC9zcGFuPlxuICAgICAgICAgICAgPHNwYW4+Jmx0Ozwvc3Bhbj48c3BhbiBjbGFzc05hbWU9XCJ1cmlcIj57dGhpcy5zdGF0ZS51cml9PC9zcGFuPjxzcGFuPiZndDs8L3NwYW4+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9IHsgJ2NhbGwgJyArIHRoaXMuc3RhdGUuY2FsbFN0YXR1cyB9PlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJidXR0b24gZGlhbFwiICAgIG9uQ2xpY2s9e3RoaXMuY2xpY2tEaWFsfT48L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYnV0dG9uIGhhbmd1cFwiICBvbkNsaWNrPXt0aGlzLmNsaWNrSGFuZ3VwfT48L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYnV0dG9uIGR0bWZcIiAgICBvbkNsaWNrPXt0aGlzLnRvZ2dsZUR0bWZ9PjwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJidXR0b24gaG9sZFwiICAgIG9uQ2xpY2s9e3RoaXMuY2xpY2tIb2xkfT48L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYnV0dG9uIHJlc3VtZVwiICBvbkNsaWNrPXt0aGlzLmNsaWNrUmVzdW1lfT48L2Rpdj5cbiAgICAgICAgICAgIHt0aGlzLnJlbmRlclRyYW5zZmVyQnV0dG9uKCl9XG4gICAgICAgICAgICB7IHRoaXMuc3RhdGUuc2hvd0R0bWZCb3g/IDxEdG1mQm94IGNhbGw9e3RoaXMuc3RhdGUuY2FsbH0vPiA6IG51bGwgfVxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjYWxsLXN0YXR1c1wiPnt0aGlzLnN0YXRlLmNhbGxTdGF0dXNUZXh0fTwvZGl2PlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDxDaGF0Qm94IGRhdGE9e3RoaXMucHJvcHMuZGF0YX1cbiAgICAgICAgICAvPlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgICk7XG4gIH1cbn0pO1xuXG52YXIgRHRtZkJveCA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcbiAgY29tcG9uZW50RGlkTW91bnQ6IGZ1bmN0aW9uKCkge1xuICAgIHZhclxuICAgICAgc2VsZiA9IHRoaXMsXG4gICAgICBkdG1mX2J1dHRvbiA9ICQoUmVhY3QuZmluZERPTU5vZGUodGhpcykpLmZpbmQoXCIuZHRtZi1idXR0b25cIik7XG5cbiAgICBkdG1mX2J1dHRvbi5jbGljayhmdW5jdGlvbigpIHtcbiAgICAgIEdVSS5idXR0b25EdG1mQ2xpY2soc2VsZi5wcm9wcy5jYWxsLCAkKHRoaXMpLnRleHQoKSk7XG4gICAgfSk7XG4gIH0sXG5cbiAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gKFxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJkdG1mLWJveFwiPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImR0bWYtcm93XCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJkdG1mLWJ1dHRvbiBkaWdpdC0xXCI+MTwvZGl2PlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZHRtZi1idXR0b24gZGlnaXQtMlwiPjI8L2Rpdj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImR0bWYtYnV0dG9uIGRpZ2l0LTNcIj4zPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImR0bWYtcm93XCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJkdG1mLWJ1dHRvbiBkaWdpdC00XCI+NDwvZGl2PlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZHRtZi1idXR0b24gZGlnaXQtNVwiPjU8L2Rpdj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImR0bWYtYnV0dG9uIGRpZ2l0LTZcIj42PC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImR0bWYtcm93XCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJkdG1mLWJ1dHRvbiBkaWdpdC03XCI+NzwvZGl2PlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZHRtZi1idXR0b24gZGlnaXQtOFwiPjg8L2Rpdj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImR0bWYtYnV0dG9uIGRpZ2l0LTlcIj45PC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImR0bWYtcm93XCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJkdG1mLWJ1dHRvbiBkaWdpdC1hc3Rlcmlza1wiPio8L2Rpdj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImR0bWYtYnV0dG9uIGRpZ2l0LTBcIj4wPC9kaXY+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJkdG1mLWJ1dHRvbiBkaWdpdC1wb3VuZFwiPiM8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9XG59KTtcblxudmFyIENoYXRCb3ggPSBSZWFjdC5jcmVhdGVDbGFzcyh7XG4gIGdldEluaXRpYWxTdGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHRleHQ6ICcnLFxuICAgICAgbnVtTWVzc2FnZXM6IDBcbiAgICB9O1xuICB9LFxuXG4gIGNvbXBvbmVudERpZE1vdW50OiBmdW5jdGlvbigpIHtcbiAgICAvL2NvbnNvbGUubG9nKCdUcnlpdDogQ2hhdEJveDo6Y29tcG9uZW50RGlkTW91bnQoKScpO1xuICAgICQoUmVhY3QuZmluZERPTU5vZGUodGhpcykpLmZpbmQoXCJpbnB1dFwiKS5mb2N1cygpO1xuICB9LFxuXG4gIGNvbXBvbmVudERpZFVwZGF0ZTogZnVuY3Rpb24ocHJldlByb3BzLCBwcmV2U3RhdGUpIHtcbiAgICAvL2NvbnNvbGUubG9nKCdUcnlpdDogQ2hhdEJveDo6Y29tcG9uZW50RGlkVXBkYXRlKCknKTtcblxuICAgIHZhciBub2RlO1xuXG4gICAgLy8gbmV3IGNoYXQgbWVzc2FnZSBhZGRlZFxuICAgIGlmICh0aGlzLnByb3BzLmRhdGEuY2hhdC5sZW5ndGggPiB0aGlzLnN0YXRlLm51bU1lc3NhZ2VzKSB7XG4gICAgICBub2RlID0gJChSZWFjdC5maW5kRE9NTm9kZSh0aGlzKSk7XG5cbiAgICAgIC8vIHNjcm9sbCB0aGUgbWVzc2FnZXMgbGlzdFxuICAgICAgbm9kZS5maW5kKFwiLmNoYXR0aW5nXCIpLnNjcm9sbFRvcCgxZTQpO1xuICAgICAgLy8gZm9jdXMgdGhlIGlucHV0XG4gICAgICBub2RlLmZpbmQoXCJpbnB1dFwiKS5mb2N1cygpO1xuXG4gICAgICB0aGlzLnNldFN0YXRlKHsgbnVtTWVzc2FnZXM6IHRoaXMucHJvcHMuZGF0YS5jaGF0Lmxlbmd0aCB9KTtcbiAgICB9XG4gIH0sXG5cbiAgaGFuZGxlQmx1cjogZnVuY3Rpb24oKSB7XG4gICAgLy9jb25zb2xlLmxvZygnVHJ5aXQ6IENoYXRCb3g6OmhhbmRsZUJsdXIoKScpO1xuXG4gICAgR1VJLmNoYXRJbnB1dEJsdXIodGhpcy5wcm9wcy5kYXRhLnVyaSk7XG4gIH0sXG5cbiAgaGFuZGxlRm9jdXM6IGZ1bmN0aW9uKCkge1xuICAgIC8vY29uc29sZS5sb2coJ1RyeWl0OiBDaGF0Qm94OjpoYW5kbGVGb2N1cygpJyk7XG4gIH0sXG5cbiAgLy8gZmlyZXMgZXZlcnl0aW1lIHRoZSBpbnB1dCBjaGFuZ2VzIChub3Qgd2hlbiBwcmVzc2luZyBlbnRlcilcbiAgaGFuZGxlQ2hhbmdlOiBmdW5jdGlvbihlKSB7XG4gICAgLy9jb25zb2xlLmxvZygnVHJ5aXQ6IENoYXRCb3g6OmhhbmRsZUNoYW5nZSgpJyk7XG5cbiAgICB2YXIgdGV4dCA9IGUudGFyZ2V0LnZhbHVlO1xuXG4gICAgdGhpcy5zZXRTdGF0ZSh7IHRleHQ6IHRleHQgfSk7XG5cbiAgICBHVUkuY2hhdElucHV0Q2hhbmdlKHRoaXMucHJvcHMuZGF0YS51cmksIHRleHQpO1xuICB9LFxuXG4gIC8vIGZpcmVzIGV2ZXJ5dGltZSBhIGtleSBpcyBwcmVzc2VkIChpbmNsdWRpbmcgZW50ZXIpXG4gIGhhbmRsZUtleURvd246IGZ1bmN0aW9uKGUpIHtcbiAgICAvL2NvbnNvbGUubG9nKCdUcnlpdDogQ2hhdEJveDo6aGFuZGxlS2V5RG93bigpJyk7XG5cbiAgICB2YXIgdGV4dCA9IHRoaXMuc3RhdGUudGV4dDtcblxuICAgIC8vIEVudGVyIHByZXNzZWQ/IGNsZWFyIHRleHRcbiAgICBpZiAoZS53aGljaCA9PSAxMykge1xuICAgICAgdGhpcy5zZXRTdGF0ZSh7IHRleHQ6ICcnfSk7XG4gICAgICBHVUkuY2hhdElucHV0Q2hhbmdlKHRoaXMucHJvcHMuZGF0YS51cmksIHRleHQsIHRydWUgLyplbnRlciovKTtcbiAgICB9XG4gIH0sXG5cbiAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICB2YXJcbiAgICAgIHNlbGYgPSB0aGlzLFxuICAgICAgZGlzcGxheU5hbWUgPSB0aGlzLnByb3BzLmRhdGEuZGlzcGxheU5hbWUsXG5cbiAgICAgIGNvcnJlY3RNZXNzYWdlID0gZnVuY3Rpb24obWVzc2FnZSkge1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgIDxiPnsobWVzc2FnZS53aG89PT0ncGVlcic/ZGlzcGxheU5hbWU6J21lJyl9PC9iPlxuICAgICAgICApO1xuICAgICAgfSxcblxuICAgICAgZXJyb3JNZXNzYWdlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgPHAgY2xhc3NOYW1lPSdlcnJvcicvPiw8aT5tZXNzYWdlIGZhaWxlZDwvaT5cbiAgICAgICAgKTtcbiAgICAgIH0sXG5cbiAgICAgIGNoYXRNZXNzYWdlcyA9IHRoaXMucHJvcHMuZGF0YS5jaGF0Lm1hcChmdW5jdGlvbihtZXNzYWdlLGkpIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICA8cCBjbGFzc05hbWU9e21lc3NhZ2Uud2hvfSBrZXk9e2l9PlxuICAgICAgICAgICAge21lc3NhZ2Uud2hvPT09J2Vycm9yJz9lcnJvck1lc3NhZ2UoKTpjb3JyZWN0TWVzc2FnZShtZXNzYWdlKX1cbiAgICAgICAgICAgICAgOiB7bWVzc2FnZS50ZXh0fVxuICAgICAgICAgIDwvcD5cbiAgICAgICAgKTtcbiAgICAgIH0pO1xuXG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY2hhdFwiPlxuICAgICAgICB7IHRoaXMucHJvcHMuZGF0YS5jaGF0Lmxlbmd0aCAhPT0gMCAmJlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdjaGF0dGluZyc+e2NoYXRNZXNzYWdlc308L2Rpdj5cbiAgICAgICAgfVxuICAgICAgICA8aW5wdXQgY2xhc3NOYW1lPXt0aGlzLnN0YXRlLnRleHQ9PT0nJz8naW5hY3RpdmUnOicnfSB0eXBlPVwidGV4dFwiIG5hbWU9XCJjaGF0LWlucHV0XCIgcGxhY2Vob2xkZXI9XCJ0eXBlIHRvIGNoYXQuLi5cIlxuICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLmhhbmRsZUNoYW5nZX1cbiAgICAgICAgICBvbktleURvd249e3RoaXMuaGFuZGxlS2V5RG93bn1cbiAgICAgICAgICBvbkZvY3VzPXt0aGlzLmhhbmRsZUZvY3VzfVxuICAgICAgICAgIG9uQmx1cj17dGhpcy5oYW5kbGVCbHVyfVxuICAgICAgICAgIHZhbHVlPXt0aGlzLnN0YXRlLnRleHR9XG4gICAgICAgIC8+XG4gICAgICAgIHsgKHRoaXMucHJvcHMuZGF0YS5pc0NvbXBvc2luZz8gPGRpdiBjbGFzc05hbWU9XCJpc2NvbXBvc2luZ1wiPjwvZGl2PiA6IG51bGwpIH1cbiAgICAgIDwvZGl2PlxuICAgICk7XG4gIH1cbn0pO1xuIl19</script></head>


<body id="body" class="bg01">
  <!-- Enable debug module -->
  <!-- Set debug -->
  <script>
  localStorage.setItem("debug", "*");
  </script>

  <!-- React.js Sessions rendering -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.13.3/react-with-addons.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.13.3/JSXTransformer.js"></script>
  <script src="resources/js/sessions.jsx" type="text/jsx"></script>

  <script src="resources/js/jquery-2.1.4.min.js" type="text/javascript"></script>
  <script src="resources/js/jquery.balloon.min.js" type="text/javascript"></script>
  <script src="resources/js/parseuri.js" type="text/javascript"></script>
  <script src="resources/js/init.js" type="text/javascript"></script>
  <script src="resources/js/gui.js" type="text/javascript"></script>
  <script src="resources/js/iscomposing.js" type="text/javascript"></script>

  <!-- For Hacking Tryit read http://tryit.jssip.net/js/custom.REMOVE_THIS.js -->

  <!-- Try to load js/custom.js file -->
  <script src="resources/js/custom.js" type="text/javascript"></script>
  <script src="resources/js/jssip.js" type="text/javascript"></script>

  <!-- Try to load rtcninja-temasys.js -->
  <script src="resources/js/rtcninja-temasys.min.js" type="text/javascript"></script>
  <!-- If CustomJsSIP is set in js/custom.js file then load JsSIP from the URL in CustomJsSIP variable. -->
  <script>
  if (window.rtcninjaTemasys) {
    rtcninjaTemasys({}, {},
      // alreadyInstalledCb
      function() {
        JsSIP.rtcninja({plugin: rtcninjaTemasys});
      },
      // needInstallCb
      function(data) {
        alert('WebRTC plugin required');
      },
      // notRequiredCb
      null
      );
  }
  </script>



  <div id="top-bar">
    <div class="description">
      <p>a functional demo of <a href="http://jssip.net/"><span>Js</span>SIP</a> "the JavaScript SIP library"</p>
    </div>

    <div id="call-invitation">
      <a href="http://tryit.jssip.net/#">invite others to call you!</a>
    </div>
  </div>

  <div id="login-full-background"></div>

  <div id="login-box">
    <div class="logo"></div>

    <form id="login-form" action="./JsSIP Tryit_files/JsSIP Tryit.html">
      <label>Name <span class="description"><span class="ie">i.e. </span>Homer Simpson</span><a href="http://tryit.jssip.net/#" class="balloon display_name"></a></label>
      <input id="display_name" tabindex="1" type="text">

      <label>SIP URI <span class="description"><span class="ie">i.e. </span>sip:homer@your-domain.com</span><a href="http://tryit.jssip.net/#" class="balloon sip_uri"></a></label>
      <input id="sip_uri" tabindex="2" type="text">

      <label>SIP password<a href="http://tryit.jssip.net/#" class="balloon sip_password"></a></label>
      <input id="sip_password" tabindex="3" type="password">

      <label>WS URI <span class="description"><span class="ie">i.e. </span>ws://your-domain.com:10080</span><a href="http://tryit.jssip.net/#" class="balloon ws_uri"></a></label>
      <input id="ws_servers" tabindex="4" type="text">

      <input type="submit" style="position: absolute; left: -9999px; width: 1px; height: 1px;">
    </form>

    <form id="login-form-from-invitation" action="./JsSIP Tryit_files/JsSIP Tryit.html">
      <label>Write your name and press Enter</label>
      <input class="display_name" type="text">
      <input type="submit" style="position: absolute; left: -9999px; width: 1px; height: 1px;">
    </form>

    <div id="advanced-settings-link">
      <a href="http://tryit.jssip.net/#">advanced settings</a>
    </div>

    <div id="advanced-settings">
      <div class="close"></div>
      <p class="link-jssip-doc">Read the documentation of the advanced settings <a href="http://jssip.net/documentation/" target="_blank">here</a>.</p>

      <form id="advanced-settings-form" action="./JsSIP Tryit_files/JsSIP Tryit.html">
        <table>
          <tbody><tr>
            <td class="label"><label>authorization_user</label></td>
            <td class="value"><input type="text" name="authorization_user"></td>
          </tr>
          <tr>
            <td class="label"><label>register</label></td>
            <td class="value"><input type="checkbox" name="register" checked=""></td>
          </tr>
          <tr>
            <td class="label"><label>register_expires</label></td>
            <td class="value"><input type="text" name="register_expires" value="600"></td>
          </tr>
          <tr>
            <td class="label"><label>registrar_server</label></td>
            <td class="value"><input type="text" name="registrar_server"></td>
          </tr>
          <tr>
            <td class="label"><label>no_answer_timeout</label></td>
            <td class="value"><input type="text" name="no_answer_timeout" value="60"></td>
          </tr>
          <tr>
            <td class="label"><label>session_timers</label></td>
            <td class="value"><input type="checkbox" name="session_timers" checked=""></td>
          </tr>
          <tr>
            <td class="label"><label>peerconnection_config (use JSON)</label></td>
            <td class="value"><input type="text" name="peerconnection_config" value="{ &quot;iceServers&quot;: [ {&quot;urls&quot;: [&quot;stun:stun.l.google.com:19302&quot;]} ], &quot;gatheringTimeout&quot;: 2000 }"></td>
          </tr>
          <tr>
            <td class="label"><label>use_preloaded_route</label></td>
            <td class="value"><input type="checkbox" name="use_preloaded_route"></td>
          </tr>
          <tr>
            <td class="label"><label>connection_recovery_min_interval</label></td>
            <td class="value"><input type="text" name="connection_recovery_min_interval" value="2"></td>
          </tr>
          <tr>
            <td class="label"><label>connection_recovery_max_interval</label></td>
            <td class="value"><input type="text" name="connection_recovery_max_interval" value="30"></td>
          </tr>
          <tr>
            <td class="label"><label>hack_via_tcp</label></td>
            <td class="value"><input type="checkbox" name="hack_via_tcp"></td>
          </tr>
          <tr>
            <td class="label"><label>hack_via_ws</label></td>
            <td class="value"><input type="checkbox" name="hack_via_ws"></td>
          </tr>
          <tr>
            <td class="label"><label>hack_ip_in_contact</label></td>
            <td class="value"><input type="checkbox" name="hack_ip_in_contact"></td>
          </tr>
        </tbody></table>
        <input type="submit" style="position: absolute; left: -9999px; width: 1px; height: 1px;">
      </form>
    </div>

    <div id="use-tryit-account-link">
      <a href="http://tryit.jssip.net/#" tabindex="1">... or use a dynamic account in our servers!</a>
    </div>

    <div id="Y_U_NO"><p></p></div>
  </div>

  <div id="phone-page">

    <div id="themes">
      <div class="theme01"></div>
      <div class="theme02"></div>
      <div class="theme03"></div>
      <div class="theme04"></div>
    </div>

    <div id="phone">

      <div class="status">
        <div id="conn-status">
          <span class="field">status: </span>
          <span class="value"></span>
        </div>
        <div>
          <span class="field">register: </span>
          <input type="checkbox" id="register">
        </div>
        <div>
          <span class="field">enable video: </span>
          <input type="checkbox" id="enableVideo" checked="">
        </div>
        <div>
          <span class="field">user: </span>
          <span class="value user"></span>
        </div>
      </div>

      <div class="controls">

        <div class="ws-disconnected"></div>

        <div class="dialbox">
          <input type="text" class="destination" value="">
          <div class="to">To:</div>
          <div class="dial-buttons">
            <div class="button call">call</div>
            <div class="line-separator"></div>
            <div class="button chat">chat</div>
          </div>
        </div>

        <div class="dialpad">
          <div class="line">
            <div class="button digit-1">1</div>
            <div class="button digit-2">2</div>
            <div class="button digit-3">3</div>
          </div>
          <div class="line-separator"></div>
          <div class="line">
            <div class="button digit-4">4</div>
            <div class="button digit-5">5</div>
            <div class="button digit-6">6</div>
          </div>
          <div class="line-separator"></div>
          <div class="line">
            <div class="button digit-7">7</div>
            <div class="button digit-8">8</div>
            <div class="button digit-9">9</div>
          </div>
          <div class="line-separator"></div>
          <div class="line">
            <div class="button digit-asterisk">*</div>
            <div class="button digit-0">0</div>
            <div class="button digit-pound">#</div>
          </div>
        </div><!-- .dialpad -->

      </div><!-- .controls -->
    </div><!-- #phone -->


    <div id="sessions"></div>

    <div id="webcam">
      <video id="remoteView" autoplay="" _hidden="true" poster="images/logo.png"></video>
    <!--<video id="remoteView" autoplay
      src="http://shapeshed.com/examples/HTML5-video-element/video/320x240.ogg">
    </video>-->

    <video id="selfView" autoplay="" muted="true" _hidden="true"></video>
    <!--<video id="selfView" autoplay
      src="http://shapeshed.com/examples/HTML5-video-element/video/320x240.ogg">
    </video>-->
  </div>

  <div id="ws_reconnect"></div>
  <div id="unregister_all"></div>
</div><!-- phone-page -->



</body></html>